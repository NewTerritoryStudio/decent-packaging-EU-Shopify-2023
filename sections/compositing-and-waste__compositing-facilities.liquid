{%- if section.settings.anchor -%}
  {%- include 'scroll-anchor' with section.settings.anchor -%}
{%- endif -%}

<div class="composting-facilities" data-section-id="{{ section.id }}" data-section-type="composting-facilities">

  <div class="container narrow">
    <div class="row">
      <div class="col-xs-12">
        <p class="h1 composting-facilities__title">{{ section.settings.title | replace: '  ', '</br>' }}</p>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 col-md-8">
        <p class="composting-facilities__text">
          {{ section.settings.text }}
        </p>
      </div>
    </div>

    <div class="composting-facilities__grid">
      
      {%- for block in section.blocks -%}

        {%- if block.type != 'facility' -%}
          {%- continue -%}
        {%- endif -%}

        {%- if block.settings.color -%}
          <style>
            #composting-facilities-grid-item--{{ forloop.index }} .composting-facilities-grid-item__icon::after { background-color: {{ block.settings.color }}; }
          </style>
        {%- endif -%}

        <a id="composting-facilities-grid-item--{{ forloop.index }}" class="composting-facilities-grid-item" href="{{ block.settings.url }}">

          <span class="composting-facilities-grid-item__icon">
            {%- include 'icon' with 'world' -%}
          </span>
          <span class="composting-facilities-grid-item__text-container">
            <p class="composting-facilities-grid-item__location">
              {{ block.settings.location }}
            </p>
            <p class="h5 composting-facilities-grid-item__title">
              {{ block.settings.title }}
            </p>
            {%- if block.settings.subtitle -%}
              <p class="composting-facilities-grid-item__subtitle">
                {{ block.settings.subtitle }}
              </p>
            {%- endif -%}
          </span>

          <span class="composting-facilities-grid-item__border-bottom">
            
          </span>

        </a>


      {%- endfor -%}

    </div>

  </div>

</div>

{% schema %}
  {
    "name": "Compositing Facilities",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title",
        "default": "Commercial  compositing facilities"
      },
      {
        "type": "textarea",
        "id": "text",
        "label": "Text",
        "default": "We work with the following 11 commercial compost sites across NZ to divert our packaging away from landfill:"
      },
      {
        "type": "text",
        "id": "anchor",
        "label": "Anchor (ADVANCED)"
      }
    ],
    "blocks": [
      {
        "name": "Facility",
        "type": "facility",
        "settings": [
          {
            "type": "text",
            "id": "location",
            "label": "Location"
          },
          {
            "type": "text",
            "id": "title",
            "label": "Title"
          },
          {
            "type": "text",
            "id": "subtitle",
            "label": "Subtitle"
          },
          {
            "type": "url",
            "id": "url",
            "label": "Url"
          },
          {
            "type": "color",
            "id": "color",
            "label": "Colour"
          }
        ]
      }
    ]
  }
{% endschema %}